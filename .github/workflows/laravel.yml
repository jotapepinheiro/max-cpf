name: Laravel

on:
  push:
    branches:
      - test
      - Homolog
      - Production
  pull_request:
    branches:
      - Homolog
      - Production

jobs:
  test-build:
    runs-on: ubuntu-latest

    outputs:
      output1: ${{ steps.step1.outputs.test }}
      output2: ${{ steps.step2.outputs.test }}
    steps:
      - id: step1
        run: echo "::set-output name=test::hello"
      - id: step2
        run: echo "::set-output name=test::world"
  build:
    runs-on: ubuntu-latest
    needs: test-build
    steps:

      - name: ðŸšš is Homolog ou Production
        if:
          contains('
          refs/heads/Homolog
          refs/heads/Production
          ', github.ref)
        run: |
          echo "github.ref " ${{ github.ref }}

      - name: ðŸŽ‰ By Pull Request Merged
        uses: actions/checkout@v2
        run: |
          echo "eventName " ${{ github.event_name }}
          echo "eventAction " ${{ github.event.action }}
          echo "is_merged " ${{ github.event.pull_request.merged }}
          echo "pullRequestSha " ${{ github.event.pull_request.head.sha }}
          echo "pullRequestRef " ${{ github.event.pull_request.head.ref }}

      - name: âœ… Deploy on server Test
        if: github.ref == 'refs/heads/test'
        run: |
          echo ${{needs.test-build.outputs.output1}} ${{needs.test-build.outputs.output2}}
          echo "github.ref " ${{ github.ref }}
          echo "pullRequestSha " ${{ github.event.pull_request.head.sha }}
          echo "pullRequestRef " ${{ github.event.pull_request.head.ref }}

      - name: âœ… Deploy on server Homolog
        if: github.ref == 'refs/heads/Homolog'
        run: |
          echo ${{needs.test-build.outputs.output1}} ${{needs.test-build.outputs.output2}}
          echo "github.ref " ${{ github.ref }}
          echo "pullRequestSha " ${{ github.event.pull_request.head.sha }}
          echo "pullRequestRef " ${{ github.event.pull_request.head.ref }}

      - name: âœ… Deploy on server Production
        if: github.ref == 'refs/heads/Production'
        run: |
          echo ${{needs.test-build.outputs.output1}} ${{needs.test-build.outputs.output2}}
          echo "github.ref " ${{ github.ref }}
          echo "pullRequestSha " ${{ github.event.pull_request.head.sha }}
          echo "pullRequestRef " ${{ github.event.pull_request.head.ref }}
